<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./assets/css/main.css">
    <title></title>
</head>
<body>

    <div class="container">

        <div class="text">
            <p class="hello">Olá</p>
            <p class="guest">Francisca dos Reis</p>
            <p class="long-text">fghfghfg electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing</p>
        </div>

        <img src="https://i.imgur.com/vagNWw0.png" />

        <div class="infos">
            <div class="date">
                <p>segunda</p>
                <p class="day">19</p>
                <p>Setembro</p>
                <p class="hour">19:00</p>
            </div>
            <div class="place">
                <p class="buffet">Karol Buffet</p>
                <p class="street">R. Noruega, 155 - Maraponga <br> Fortaleza - CE, 60710-780</p>
            </div>
        </div>


        <div class="animals">

        </div>

    

    <div class="buttons">
        <button style="" onclick="confirm()">
            confirmar presença
        </button>
        <div>
            <a href="https://goo.gl/maps/Vk6UZgT456rm9ger8">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 0c-4.198 0-8 3.403-8 7.602 0 4.198 3.469 9.21 8 16.398 4.531-7.188 8-12.2 8-16.398 0-4.199-3.801-7.602-8-7.602zm0 11c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z" fill="#fff"/></svg>
            </a>
            <a href="./ellie.ics">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M20 20h-4v-4h4v4zm-6-10h-4v4h4v-4zm6 0h-4v4h4v-4zm-12 6h-4v4h4v-4zm6 0h-4v4h4v-4zm-6-6h-4v4h4v-4zm16-8v22h-24v-22h3v1c0 1.103.897 2 2 2s2-.897 2-2v-1h10v1c0 1.103.897 2 2 2s2-.897 2-2v-1h3zm-2 6h-20v14h20v-14zm-2-7c0-.552-.447-1-1-1s-1 .448-1 1v2c0 .552.447 1 1 1s1-.448 1-1v-2zm-14 2c0 .552-.447 1-1 1s-1-.448-1-1v-2c0-.552.447-1 1-1s1 .448 1 1v2z" fill="#fff"/></svg>
            </a>
        </div>
    </div>

    
    <script>

        const url = window.location.search;
        const id = url.split('?id=')[1];
        fetch(`http://localhost:3333/guest/${id}`)
        .then(function(response) {
            return response.json();
        }).then(function(data) {
            console.log(data);

            document.querySelector('span').innerHTML = data;

        }).catch(function(error) {
            console.log(error);
        }).finally(function() {
            console.log('finally');
        });

        function confirm(){
            fetch(`http://localhost:3333/confirm/${id}`, {
                method: 'POST'
            })
            .then(function(response) {
                return response.json();
            }).then(function(data) {
                console.log(data);

                document.querySelector('div').innerHTML = 'presença confirmada!';

            }).catch(function(error) {
                console.log(error);
            });
        }

        function checkConfirm(){
            fetch(`http://localhost:3333/confirm/${id}`, {
                method: 'POST'
            })
            .then(function(response) {
                return response.json();
            }).then(function(data) {
                console.log(data);
                if(data.message !== 'Guest already confirmed'){
                    document.querySelector('button').style.display = 'block';
                }
            }).catch(function(error) {
                console.log(error);
            });
        }

        document.addEventListener('DOMContentLoaded', function () {
            // checkConfirm();
        });


    </script>


</body>
</html>